<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Shape Constrained-Generalized Additive Models | GAM-NICHE: Shape-Constrained GAMs to build Species Distribution Models under the ecological niche theory</title>
  <meta name="description" content="This is a short tutorial for constructing species distribution models in R using shape-constrained generalized additive models, based on the development and application to marine fish by Citores et al. (2020)." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Shape Constrained-Generalized Additive Models | GAM-NICHE: Shape-Constrained GAMs to build Species Distribution Models under the ecological niche theory" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a short tutorial for constructing species distribution models in R using shape-constrained generalized additive models, based on the development and application to marine fish by Citores et al. (2020)." />
  <meta name="github-repo" content="Fundacion-AZTI/gam-niche" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Shape Constrained-Generalized Additive Models | GAM-NICHE: Shape-Constrained GAMs to build Species Distribution Models under the ecological niche theory" />
  
  <meta name="twitter:description" content="This is a short tutorial for constructing species distribution models in R using shape-constrained generalized additive models, based on the development and application to marine fish by Citores et al. (2020)." />
  

<meta name="author" content="AZTI" />


<meta name="date" content="2023-05-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prepare-the-final-dataset.html"/>
<link rel="next" href="model-validation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="images/logo_gam_niche.jpg" width="250"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="presence-absence-data.html"><a href="presence-absence-data.html"><i class="fa fa-check"></i><b>2</b> Presence-absence data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="presence-absence-data.html"><a href="presence-absence-data.html#download-presence-data"><i class="fa fa-check"></i><b>2.1</b> Download presence data</a></li>
<li class="chapter" data-level="2.2" data-path="presence-absence-data.html"><a href="presence-absence-data.html#create-pseudo-absence-data"><i class="fa fa-check"></i><b>2.2</b> Create pseudo-absence data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="environmental-data.html"><a href="environmental-data.html"><i class="fa fa-check"></i><b>3</b> Environmental data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="environmental-data.html"><a href="environmental-data.html#download-from-public-repositories"><i class="fa fa-check"></i><b>3.1</b> Download from public repositories</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prepare-the-final-dataset.html"><a href="prepare-the-final-dataset.html"><i class="fa fa-check"></i><b>4</b> Prepare the final dataset</a>
<ul>
<li class="chapter" data-level="4.1" data-path="prepare-the-final-dataset.html"><a href="prepare-the-final-dataset.html#extract-environmental-data-associated-to-species-distribution-data"><i class="fa fa-check"></i><b>4.1</b> Extract environmental data associated to species distribution data</a></li>
<li class="chapter" data-level="4.2" data-path="prepare-the-final-dataset.html"><a href="prepare-the-final-dataset.html#exploratory-plots-of-environmental-variables"><i class="fa fa-check"></i><b>4.2</b> Exploratory plots of environmental variables</a></li>
<li class="chapter" data-level="4.3" data-path="prepare-the-final-dataset.html"><a href="prepare-the-final-dataset.html#exploratory-plots-of-environmental-variables-depending-on-species-distribution-data"><i class="fa fa-check"></i><b>4.3</b> Exploratory plots of environmental variables depending on species distribution data</a></li>
<li class="chapter" data-level="4.4" data-path="prepare-the-final-dataset.html"><a href="prepare-the-final-dataset.html#correlation-analysis"><i class="fa fa-check"></i><b>4.4</b> Correlation analysis</a></li>
<li class="chapter" data-level="4.5" data-path="prepare-the-final-dataset.html"><a href="prepare-the-final-dataset.html#variance-inflation-factor-vif"><i class="fa fa-check"></i><b>4.5</b> Variance Inflation Factor (VIF)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="shape-constrained-generalized-additive-models.html"><a href="shape-constrained-generalized-additive-models.html"><i class="fa fa-check"></i><b>5</b> Shape Constrained-Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="shape-constrained-generalized-additive-models.html"><a href="shape-constrained-generalized-additive-models.html#model-fit"><i class="fa fa-check"></i><b>5.1</b> Model fit</a></li>
<li class="chapter" data-level="5.2" data-path="shape-constrained-generalized-additive-models.html"><a href="shape-constrained-generalized-additive-models.html#model-selection"><i class="fa fa-check"></i><b>5.2</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-validation.html"><a href="model-validation.html"><i class="fa fa-check"></i><b>6</b> Model validation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-validation.html"><a href="model-validation.html#optimum-threshold"><i class="fa fa-check"></i><b>6.1</b> Optimum threshold</a></li>
<li class="chapter" data-level="6.2" data-path="model-validation.html"><a href="model-validation.html#k-fold-validation"><i class="fa fa-check"></i><b>6.2</b> k-fold validation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="prediction-and-maps.html"><a href="prediction-and-maps.html"><i class="fa fa-check"></i><b>7</b> Prediction and maps</a>
<ul>
<li class="chapter" data-level="7.1" data-path="prediction-and-maps.html"><a href="prediction-and-maps.html#prepare-environmental-data"><i class="fa fa-check"></i><b>7.1</b> Prepare environmental data</a></li>
<li class="chapter" data-level="7.2" data-path="prediction-and-maps.html"><a href="prediction-and-maps.html#projection"><i class="fa fa-check"></i><b>7.2</b> Projection</a></li>
<li class="chapter" data-level="7.3" data-path="prediction-and-maps.html"><a href="prediction-and-maps.html#mapping"><i class="fa fa-check"></i><b>7.3</b> Mapping</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>8</b> Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GAM-NICHE: Shape-Constrained GAMs to build Species Distribution Models under the ecological niche theory</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="shape-constrained-generalized-additive-models" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Shape Constrained-Generalized Additive Models<a href="shape-constrained-generalized-additive-models.html#shape-constrained-generalized-additive-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In order to fit SDM in agreement with the ecological niche theory, the proposed Shape-Constrained Generalized Additive Models (SC-GAMs) in <span class="citation">(<a href="#ref-citores_etal_2020" role="doc-biblioref">Citores et al. 2020</a>)</span> are fitted in this section. SC-GAMs are based on Generalized Additive Models, allowing us to impose shape-constraints to the linear predictor function. The R package SCAM implements the general framework developed by <span class="citation">(<a href="#ref-pya_etal_2015" role="doc-biblioref">Pya and Wood 2015</a>)</span> using shape-constrained P-splines. Monotonicity and concavity/convexity constraints can be imposed on the sign of the first and/or the second derivatives of the smooth terms. For fitting Species Distribution Models in agreement with the ecological niche theory, we imposed concavity constraints (<span class="math inline">\(f&#39;&#39;(x) \le 0\)</span>), so that the response can presents at most a single mode.</p>
<p>Alternatively, the R package <code>mboost</code> fits SC-GAMs using boosting methods. We are not going to develop this alternative here.</p>
<p>First, we load the list of required libraries.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="shape-constrained-generalized-additive-models.html#cb93-1" aria-hidden="true" tabindex="-1"></a>requiredPackages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb93-2"><a href="shape-constrained-generalized-additive-models.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#GENERAL USE LIBRARIES --------#</span></span>
<span id="cb93-3"><a href="shape-constrained-generalized-additive-models.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;here&quot;</span>, <span class="co"># Library for reproducible workflow</span></span>
<span id="cb93-4"><a href="shape-constrained-generalized-additive-models.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;rstudioapi&quot;</span>,  <span class="co"># Library for reproducible workflow</span></span>
<span id="cb93-5"><a href="shape-constrained-generalized-additive-models.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;stringr&quot;</span>,</span>
<span id="cb93-6"><a href="shape-constrained-generalized-additive-models.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;RColorBrewer&quot;</span>,  </span>
<span id="cb93-7"><a href="shape-constrained-generalized-additive-models.html#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ggplot2&quot;</span>,</span>
<span id="cb93-8"><a href="shape-constrained-generalized-additive-models.html#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;dplyr&quot;</span>,</span>
<span id="cb93-9"><a href="shape-constrained-generalized-additive-models.html#cb93-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb93-10"><a href="shape-constrained-generalized-additive-models.html#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#SPATIAL DATA --------#</span></span>
<span id="cb93-11"><a href="shape-constrained-generalized-additive-models.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;rgdal&quot;</span>,</span>
<span id="cb93-12"><a href="shape-constrained-generalized-additive-models.html#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;fields&quot;</span>,</span>
<span id="cb93-13"><a href="shape-constrained-generalized-additive-models.html#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;maps&quot;</span> ,</span>
<span id="cb93-14"><a href="shape-constrained-generalized-additive-models.html#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;raster&quot;</span>,</span>
<span id="cb93-15"><a href="shape-constrained-generalized-additive-models.html#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="shape-constrained-generalized-additive-models.html#cb93-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#MODEL FIT --------#</span></span>
<span id="cb93-17"><a href="shape-constrained-generalized-additive-models.html#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;scam&quot;</span>,</span>
<span id="cb93-18"><a href="shape-constrained-generalized-additive-models.html#cb93-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;plotmo&quot;</span>,</span>
<span id="cb93-19"><a href="shape-constrained-generalized-additive-models.html#cb93-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;SDMTools&quot;</span>,</span>
<span id="cb93-20"><a href="shape-constrained-generalized-additive-models.html#cb93-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;pkgbuild&quot;</span>,</span>
<span id="cb93-21"><a href="shape-constrained-generalized-additive-models.html#cb93-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;dismo&quot;</span></span>
<span id="cb93-22"><a href="shape-constrained-generalized-additive-models.html#cb93-22" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>We run a function to install the required packages that are not in our system and load all the required packages.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="shape-constrained-generalized-additive-models.html#cb94-1" aria-hidden="true" tabindex="-1"></a>install_load_function <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg){</span>
<span id="cb94-2"><a href="shape-constrained-generalized-additive-models.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  new.pkg <span class="ot">&lt;-</span> pkg[<span class="sc">!</span>(pkg <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[, <span class="st">&quot;Package&quot;</span>])]</span>
<span id="cb94-3"><a href="shape-constrained-generalized-additive-models.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(new.pkg))</span>
<span id="cb94-4"><a href="shape-constrained-generalized-additive-models.html#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(new.pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-5"><a href="shape-constrained-generalized-additive-models.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(pkg, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-6"><a href="shape-constrained-generalized-additive-models.html#cb94-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-7"><a href="shape-constrained-generalized-additive-models.html#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="shape-constrained-generalized-additive-models.html#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install_load_function</span>(requiredPackages)</span></code></pre></div>
<pre><code>##         here   rstudioapi      stringr RColorBrewer      ggplot2        dplyr 
##         TRUE         TRUE         TRUE         TRUE         TRUE         TRUE 
##        rgdal       fields         maps       raster         scam       plotmo 
##         TRUE         TRUE         TRUE         TRUE         TRUE         TRUE 
##     SDMTools     pkgbuild        dismo 
##         TRUE         TRUE         TRUE</code></pre>
<p>Install and load SDMTools. You need to manually install RTools: <a href="https://cran.r-project.org/bin/windows/Rtools/history.html" class="uri">https://cran.r-project.org/bin/windows/Rtools/history.html</a></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="shape-constrained-generalized-additive-models.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find_rtools()</span></span>
<span id="cb96-2"><a href="shape-constrained-generalized-additive-models.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb96-3"><a href="shape-constrained-generalized-additive-models.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;remotes&quot;)</span></span>
<span id="cb96-4"><a href="shape-constrained-generalized-additive-models.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_version(&quot;SDMTools&quot;, version = &quot;1.1-221.2&quot;)</span></span></code></pre></div>
<p>We define some overall settings.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="shape-constrained-generalized-additive-models.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># General settings for ggplot (black-white background, larger base_size)</span></span>
<span id="cb97-2"><a href="shape-constrained-generalized-additive-models.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>))</span></code></pre></div>
<div id="model-fit" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Model fit<a href="shape-constrained-generalized-additive-models.html#model-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We set the working directory to the folder where the current script is located and we load the dataset (PAdata_with_env.Rdata) containing the presence-absence data together with the environmental data.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="shape-constrained-generalized-additive-models.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span> (<span class="st">&quot;data&quot;</span>, <span class="st">&quot;outputs_for_modelling&quot;</span>, <span class="st">&quot;PAdata_with_env.Rdata&quot;</span>))</span></code></pre></div>
<p>To fit a logistic regression model in the SC-GAMs framework, we use the scam function, where we set the binomial family with the logit link function. Our response variable is the presence-absence data and the selected three explanatory variables are the SST, chlorophyll and salinity. Each variable is included in the model through an spline function where the concavity constraint is set using bs=“cv”. The details about this option can be found in the section “Constructor for concave P-splines in SCAMs” of the SCAM manual (<a href="https://cran.r-project.org/web/packages/scam/scam.pdf" class="uri">https://cran.r-project.org/web/packages/scam/scam.pdf</a>). The number of knots (k) is fixed at 8 in this example for a good balance between flexibility and computation time.</p>
<p><strong>UNIVARIATE MODELS</strong></p>
<p>Before fitting the model with the selected three environmental variables, we can fit univariate model as follows.</p>
<p>We fit the univariate model for SST, we print the summary of the model fit, and look at the fitted curve in the response scale.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="shape-constrained-generalized-additive-models.html#cb99-1" aria-hidden="true" tabindex="-1"></a>model_sst <span class="ot">&lt;-</span> <span class="fu">scam</span> (occurrenceStatus <span class="sc">~</span>  <span class="fu">s</span>(BO_sstmean, <span class="at">k=</span><span class="dv">8</span>,<span class="at">bs=</span><span class="st">&quot;cv&quot;</span>), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>data)</span>
<span id="cb99-2"><a href="shape-constrained-generalized-additive-models.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_sst)</span></code></pre></div>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ s(BO_sstmean, k = 8, bs = &quot;cv&quot;)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -47.180      2.182  -21.62   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df Chi.sq p-value    
## s(BO_sstmean)   2      2   1111  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.2607   Deviance explained = 23.1%
## UBRE score = 0.066363  Scale est. = 1         n = 29661</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="shape-constrained-generalized-additive-models.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmo</span>(model_sst,<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">pt.col=</span><span class="dv">8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="1536" /></p>
<p>We repeat the same steps for the rest of the variables.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="shape-constrained-generalized-additive-models.html#cb102-1" aria-hidden="true" tabindex="-1"></a>model_chl <span class="ot">&lt;-</span> <span class="fu">scam</span> (occurrenceStatus <span class="sc">~</span>  <span class="fu">s</span>(BO2_chlomean_ss, <span class="at">k=</span><span class="dv">8</span>,<span class="at">bs=</span><span class="st">&quot;cv&quot;</span>), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>data)</span>
<span id="cb102-2"><a href="shape-constrained-generalized-additive-models.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_chl)</span></code></pre></div>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ s(BO2_chlomean_ss, k = 8, bs = &quot;cv&quot;)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -2.3878     0.0417  -57.27   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                    edf Ref.df Chi.sq p-value    
## s(BO2_chlomean_ss)   1      1   3263  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## Rank: 7/8
## 
## R-sq.(adj) =  0.1546   Deviance explained = 12.4%
## UBRE score = 0.21423  Scale est. = 1         n = 29661</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="shape-constrained-generalized-additive-models.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmo</span>(model_chl,<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">pt.col=</span><span class="dv">8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" width="1536" /></p>
<p>Due to convergence issues, sometimes it is necessary to fix the smoothing parameter (sp) at small value, i.e. <span class="math inline">\(10^{-5}\)</span>, as here when introducing salinity as an explanatory variable. If no value is provided, the smoothing parameter is estimated within the model.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="shape-constrained-generalized-additive-models.html#cb105-1" aria-hidden="true" tabindex="-1"></a>model_sal <span class="ot">&lt;-</span> <span class="fu">scam</span> (occurrenceStatus <span class="sc">~</span>  <span class="fu">s</span>(BO2_salinitymean_ss, <span class="at">k=</span><span class="dv">8</span>,<span class="at">bs=</span><span class="st">&quot;cv&quot;</span>), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>data,<span class="at">sp=</span><span class="fl">0.00001</span>)</span>
<span id="cb105-2"><a href="shape-constrained-generalized-additive-models.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_sal)</span></code></pre></div>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ s(BO2_salinitymean_ss, k = 8, bs = &quot;cv&quot;)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -50.076      1.853  -27.02   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                        edf Ref.df Chi.sq p-value    
## s(BO2_salinitymean_ss)   2      2  913.1  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0514   Deviance explained = 4.38%
##   Scale est. = 1         n = 29661</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="shape-constrained-generalized-additive-models.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmo</span>(model_sal,<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">pt.col=</span><span class="dv">8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="1536" /></p>
<p><strong>MODEL WITH ALL VARIABLES</strong></p>
<p>Now we fit the model including the three selected variables.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="shape-constrained-generalized-additive-models.html#cb108-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">scam</span> (occurrenceStatus <span class="sc">~</span>  <span class="fu">s</span>(BO_sstmean, <span class="at">k=</span><span class="dv">8</span>,<span class="at">bs=</span><span class="st">&quot;cv&quot;</span>)<span class="sc">+</span> <span class="fu">s</span>(BO2_salinitymean_ss, <span class="at">k=</span><span class="dv">8</span>,<span class="at">bs=</span><span class="st">&quot;cv&quot;</span>)<span class="sc">+</span><span class="fu">s</span>(BO2_chlomean_ss, <span class="at">k=</span><span class="dv">8</span>,<span class="at">bs=</span><span class="st">&quot;cv&quot;</span>), <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>), <span class="at">data=</span>data,<span class="at">sp=</span><span class="fu">rep</span>(<span class="fl">0.00001</span>,<span class="dv">3</span>))</span>
<span id="cb108-2"><a href="shape-constrained-generalized-additive-models.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ s(BO_sstmean, k = 8, bs = &quot;cv&quot;) + s(BO2_salinitymean_ss, 
##     k = 8, bs = &quot;cv&quot;) + s(BO2_chlomean_ss, k = 8, bs = &quot;cv&quot;)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)   -56.08      45.69  -1.227     0.22
## 
## Approximate significance of smooth terms:
##                          edf Ref.df Chi.sq p-value    
## s(BO_sstmean)          3.936  3.999  772.6  &lt;2e-16 ***
## s(BO2_salinitymean_ss) 2.001  2.001  191.4  &lt;2e-16 ***
## s(BO2_chlomean_ss)     3.985  4.003 1820.7  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.3488   Deviance explained = 31.9%
##   Scale est. = 1         n = 29661</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="shape-constrained-generalized-additive-models.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmo</span>(model,<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">pt.col=</span><span class="dv">8</span>)</span></code></pre></div>
<pre><code>##  plotmo grid:    BO_sstmean BO2_salinitymean_ss BO2_chlomean_ss
##                    18.89921            35.42666       0.2452632</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="1536" /></p>
<p>We can see in the summary of the fit, that all included variables are statistically significant (with p&lt;0.05) and present a unimodal response curve.</p>
<p>For a more detailed check of the fitting, we can use the scam.check function:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="shape-constrained-generalized-additive-models.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scam.check</span>(model)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="1536" /></p>
<pre><code>## 
## Method: UBRE   Optimizer: NA newton
## The optimal smoothing parameter(s): 1e-05 1e-05 1e-05 .</code></pre>
</div>
<div id="model-selection" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Model selection<a href="shape-constrained-generalized-additive-models.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When several explanatory variables are available, a variable selection process can be carried out. Here we provide as an example, a function that performs forward variable selection (modsel.scam) based on the significance of variables and AIC values of the fits.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="shape-constrained-generalized-additive-models.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;function/function_scam_selection_optimized.R&quot;</span>)</span></code></pre></div>
<p>We save the names of the variables we want to introduce for the variable selection process as a vector:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="shape-constrained-generalized-additive-models.html#cb115-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BO_sstmean&quot;</span>,</span>
<span id="cb115-2"><a href="shape-constrained-generalized-additive-models.html#cb115-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;BO2_salinitymean_ss&quot;</span>,</span>
<span id="cb115-3"><a href="shape-constrained-generalized-additive-models.html#cb115-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;BO2_chlomean_ss&quot;</span>)</span></code></pre></div>
<p>The default AIC tolerance is 2 and there is not a limit on selected terms in this example. These options can be modified through aic.tol and vmax arguments in the function. The number of knots and the sp can be also modified.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="shape-constrained-generalized-additive-models.html#cb116-1" aria-hidden="true" tabindex="-1"></a>model_SCGAM <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">modsel.scam</span>(<span class="at">basef=</span><span class="st">&quot;occurrenceStatus ~ 1&quot;</span>, <span class="at">vars=</span>vars, <span class="at">dat=</span>data,<span class="at">sp=</span><span class="fl">0.00001</span>), <span class="at">silent=</span>T)  </span></code></pre></div>
<pre><code>## [1] &quot;Fitting models with 1 terms&quot;
##   occurrenceStatus ~ 1+s(BO_sstmean,m=2,bs=&#39;cv&#39;,k=8) 
##   occurrenceStatus ~ 1+s(BO2_salinitymean_ss,m=2,bs=&#39;cv&#39;,k=8) 
##   occurrenceStatus ~ 1+s(BO2_chlomean_ss,m=2,bs=&#39;cv&#39;,k=8) 
## [1] &quot;Fitting models with 2 terms&quot;
##   occurrenceStatus ~ 1+s(BO_sstmean,m=2,bs=&#39;cv&#39;,k=8)+s(BO2_salinitymean_ss,m=2,bs=&#39;cv&#39;,k=8) 
##   occurrenceStatus ~ 1+s(BO_sstmean,m=2,bs=&#39;cv&#39;,k=8)+s(BO2_chlomean_ss,m=2,bs=&#39;cv&#39;,k=8) 
## [1] &quot;Fitting models with 3 terms&quot;
##   occurrenceStatus ~ 1+s(BO_sstmean,m=2,bs=&#39;cv&#39;,k=8)+s(BO2_chlomean_ss,m=2,bs=&#39;cv&#39;,k=8)+s(BO2_salinitymean_ss,m=2,bs=&#39;cv&#39;,k=8)</code></pre>
<p>We check results of the selected model, such as, selected variable names:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="shape-constrained-generalized-additive-models.html#cb118-1" aria-hidden="true" tabindex="-1"></a>model_SCGAM<span class="sc">$</span>svars</span></code></pre></div>
<pre><code>## [1] &quot;BO_sstmean&quot;          &quot;BO2_chlomean_ss&quot;     &quot;BO2_salinitymean_ss&quot;</code></pre>
<p>AICs of the fitted models:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="shape-constrained-generalized-additive-models.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(model_SCGAM<span class="sc">$</span>smod, AIC)</span></code></pre></div>
<pre><code>##                null          BO_sstmean     BO2_chlomean_ss BO2_salinitymean_ss 
##            41120.17            31629.43            28388.33            28032.06</code></pre>
<p>Explained deviance of fitted models:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="shape-constrained-generalized-additive-models.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(model_SCGAM<span class="sc">$</span>smod, <span class="cf">function</span>(x) <span class="fu">summary</span>(x)<span class="sc">$</span>dev.expl)</span></code></pre></div>
<pre><code>##                null          BO_sstmean     BO2_chlomean_ss BO2_salinitymean_ss 
##        3.539048e-16        2.309134e-01        3.100285e-01        3.187874e-01</code></pre>
<p>Formulas of the fitted models:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="shape-constrained-generalized-additive-models.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(model_SCGAM<span class="sc">$</span>smod, formula)</span></code></pre></div>
<pre><code>## $null
## occurrenceStatus ~ 1
## &lt;environment: 0x00000210994d6930&gt;
## 
## $BO_sstmean
## occurrenceStatus ~ 1 + s(BO_sstmean, m = 2, bs = &quot;cv&quot;, k = 8)
## &lt;environment: 0x00000210994d6930&gt;
## 
## $BO2_chlomean_ss
## occurrenceStatus ~ 1 + s(BO_sstmean, m = 2, bs = &quot;cv&quot;, k = 8) + 
##     s(BO2_chlomean_ss, m = 2, bs = &quot;cv&quot;, k = 8)
## &lt;environment: 0x00000210994d6930&gt;
## 
## $BO2_salinitymean_ss
## occurrenceStatus ~ 1 + s(BO_sstmean, m = 2, bs = &quot;cv&quot;, k = 8) + 
##     s(BO2_chlomean_ss, m = 2, bs = &quot;cv&quot;, k = 8) + s(BO2_salinitymean_ss, 
##     m = 2, bs = &quot;cv&quot;, k = 8)
## &lt;environment: 0x00000210994d6930&gt;</code></pre>
<p>Summaries of the fitted models:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="shape-constrained-generalized-additive-models.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(model_SCGAM<span class="sc">$</span>smod, summary)</span></code></pre></div>
<pre><code>## $null
## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ 1
## &lt;environment: 0x00000210994d6930&gt;
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept) 0.009777   0.011613   0.842      0.4
## 
## 
## R-sq.(adj) =      0   Deviance explained = 3.54e-14%
##   Scale est. = 1         n = 29661
## 
## 
## $BO_sstmean
## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ 1 + s(BO_sstmean, m = 2, bs = &quot;cv&quot;, k = 8)
## &lt;environment: 0x00000210994d6930&gt;
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -47.30       3.12  -15.16   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df Chi.sq p-value    
## s(BO_sstmean)   2      2  987.3  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.2607   Deviance explained = 23.1%
##   Scale est. = 1         n = 29661
## 
## 
## $BO2_chlomean_ss
## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ 1 + s(BO_sstmean, m = 2, bs = &quot;cv&quot;, k = 8) + 
##     s(BO2_chlomean_ss, m = 2, bs = &quot;cv&quot;, k = 8)
## &lt;environment: 0x00000210994d6930&gt;
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)   -40.38      89.57  -0.451    0.652
## 
## Approximate significance of smooth terms:
##                      edf Ref.df Chi.sq p-value    
## s(BO_sstmean)      3.978  4.004  938.3  &lt;2e-16 ***
## s(BO2_chlomean_ss) 4.002  4.005 2374.3  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.3399   Deviance explained =   31%
##   Scale est. = 1         n = 29661
## 
## 
## $BO2_salinitymean_ss
## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## occurrenceStatus ~ 1 + s(BO_sstmean, m = 2, bs = &quot;cv&quot;, k = 8) + 
##     s(BO2_chlomean_ss, m = 2, bs = &quot;cv&quot;, k = 8) + s(BO2_salinitymean_ss, 
##     m = 2, bs = &quot;cv&quot;, k = 8)
## &lt;environment: 0x00000210994d6930&gt;
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)   -56.08      45.69  -1.227     0.22
## 
## Approximate significance of smooth terms:
##                          edf Ref.df Chi.sq p-value    
## s(BO_sstmean)          3.936  3.999  772.6  &lt;2e-16 ***
## s(BO2_chlomean_ss)     3.985  4.003 1820.7  &lt;2e-16 ***
## s(BO2_salinitymean_ss) 2.001  2.001  191.4  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.3488   Deviance explained = 31.9%
##   Scale est. = 1         n = 29661</code></pre>
<p>The last model of the list, is the selected one. Which in this case contains the considered three variables.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="shape-constrained-generalized-additive-models.html#cb128-1" aria-hidden="true" tabindex="-1"></a>selected_model <span class="ot">&lt;-</span> model_SCGAM<span class="sc">$</span>smod[[<span class="fu">length</span>(model_SCGAM<span class="sc">$</span>smod)]]</span></code></pre></div>
<p>We save the selected model</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="shape-constrained-generalized-additive-models.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">list=</span><span class="st">&quot;selected_model&quot;</span>, <span class="at">file=</span><span class="st">&quot;models/selected_model.RData&quot;</span>)</span></code></pre></div>
<p>Note that there are multiple options and criteria for model selection that are not reviewed here. Any model selection technique used for GAMs can be used also for SC-GAMs.</p>

<!-- 
This file is part of a gitbook that should be cited as: 

Valle, M., Citores, L., Ibaibarriaga, L., Chust, C. (2023) GAM-NICHE: Shape-Constrained GAMs to build Species Distribution Models under the ecological niche theory. AZTI. https://doi.org/10.57762/fzpy-6w51 

This tutorial has been supported by the European Union’s Horizon 2020 research and innovation programme under grant agreements No 862428 MISSION ATLANTIC project
-->
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-citores_etal_2020" class="csl-entry">
Citores, L, L Ibaibarriaga, DJ Lee, MJ Brewer, M Santos, and G Chust. 2020. <span>“Modelling Species Presence–Absence in the Ecological Niche Theory Framework Using Shape-Constrained Generalized Additive Models.”</span> <em>Ecological Modelling</em> 418: 108926. <a href="https://doi.org/10.1016/j.ecolmodel.2019.108926">https://doi.org/10.1016/j.ecolmodel.2019.108926</a>.
</div>
<div id="ref-pya_etal_2015" class="csl-entry">
Pya, N, and SN Wood. 2015. <span>“Shape Constrained Additive Models.”</span> <em>Statistics and Computing</em> 25: 543–59.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prepare-the-final-dataset.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-validation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Fundacion-AZTI/gam-niche/edit/master/05-model_fit.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
